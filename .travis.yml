dist: trusty
sudo: required
language: go
go:
  - "1.10.x"
services:
  - docker
env:
  global:
    - DOCKER_IMAGE="fuzzyfrog/microcosm"
script:
  - go test -v ./...
  - docker build -t ${DOCKER_IMAGE}:${TRAVIS_COMMIT} -f docker/Dockerfile .
after_success:
  - docker login -u ${DOCKER_USERNAME} -p ${DOCKER_PASSWORD}
  - docker push ${DOCKER_IMAGE}